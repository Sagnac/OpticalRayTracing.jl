var documenterSearchIndex = {"docs":
[{"location":"Plotting Examples/#Plotting-Examples","page":"Plotting Examples","title":"Plotting Examples","text":"Plotting is supported with the installation of any Makie backend.","category":"section"},{"location":"Plotting Examples/#Ray-Trace-Plots","page":"Plotting Examples","title":"Ray Trace Plots","text":"Supported keyword arguments are:\n\ntheme (using Makie's theme customizability);\nray_colors (a two-tuple of the marginal & chief ray colors);\nsurface_color (for the optical element surfaces & image plane);\nanything Makie's lines accepts.\n\nUsing the mutating rayplot! version will draw on top of the current figure.\n\nusing GLMakie\n\ntheme = theme_black()\nsurface_color = :white\nray_colors = (:cyan, :red)\n\nrayplot(surfaces, system; theme, surface_color, ray_colors)\n\nrays = raytrace(system, -24.0, -1.5 * system.f)\nfig = rayplot(rays)\nrays = raytrace(system, 24.0, -1.5 * system.f)\nrayplot!(rays)\n\n(Image: rayplot) (Image: rays)","category":"section"},{"location":"Plotting Examples/#Aberration-Plots","page":"Plotting Examples","title":"Aberration Plots","text":"The fan plots are interactive and include a slider which allows dynamic adjustment of the field.\n\nusing GLMakie\n\nwavefan(W)\nrayfan(W, system)\nfield_curves(W, system)\npercent_distortion(W, system)\nspot_size(W, system)\n\n(Image: wavefan) (Image: rayfan) (Image: field_curves) (Image: percent_distortion) (Image: spot_size)","category":"section"},{"location":"Seidel Aberrations/#Seidel-Aberrations","page":"Seidel Aberrations","title":"Seidel Aberrations","text":"The total system coefficients can be extracted by querying the relevant WIJK fields. In addition, chromatic aberration can be quantified for a given δn dispersion vector. The results are optical path differences in waves at the d spectral line for a system in mm; the wavelength parameter can also be tuned.\n\nW = aberrations(surfaces, system)\n\nThe return value holds the relevant metadata in an Aberration structure which can be evaluated over the pupil if called with polar coordinates and a normalized field value. The long form named fields (spherical, coma, astigmatism, etc.) hold the per surface coefficient vectors. W220P / petzval, W220T / tangential, & W220 / sagittal refer to the respective field curvatures while the W020 & W111 coefficients refer to defocus & tilt from axial & lateral color, respectively.\n\nThe coefficients assume a positive valued field.","category":"section"},{"location":"Vignetting Analysis/#Vignetting-Analysis","page":"Vignetting Analysis","title":"Vignetting Analysis","text":"Given a system or ray bundle and a set of apertures this package provides a basic tool for evaluating vignetting criteria at each aperture. Along with identifying, by index, which apertures cause partial or full vignetting, the returned Vignetting data structure holds a 5 column semi-diameter matrix in its M field which contains:\n\nThe provided aperture size;\nThe marginal ray limit: the size at which the aperture becomes the stop due to limiting the on-axis ray bundle;\nThe size necessary for no vignetting to occur;\nThe size at which the half-vignetting condition is satisified;\nThe size at which the aperture clips the entire off-axis ray bundle; this is the minimum aperture size at which the given field of view is still supported down to approximately zero irradiance.\n\nIn addition, the maximum system field of view for the unvignetted, half-vignetted, and fully-vignetted cases is determined for the input aperture sizes.\n\nQuerying the FOV field extracts the maximum supported full fields of view in degrees, paraxial principal ray slopes, and the corresponding image heights for all three vignetting conditions as a matrix with the rows corresponding to the conditions and the columns to the fields, slopes, and heights, respectively.\n\nIn essence, the M matrix represents the supported aperture sizes for each case given the system field of view and the FOV matrix corresponds to the maximal fields for the given aperture sizes.\n\nAny NaNs in the M matrix signify that there is no possible size which fits the criteria due to the aforementioned limiting factor.\n\nvig = vignetting(system)\n\n# FOVs, slopes, heights\nvig.FOV\n\nThere is support for analyzing a traced RayBasis instead using the vignetting(rays::RayBasis, system::System, a::AbstractVector) method.","category":"section"},{"location":"#OpticalRayTracing.jl","page":"OpticalRayTracing.jl","title":"OpticalRayTracing.jl","text":"First order paraxial ray tracing, optical system solving, and third order aberration analysis.\n\n\n\nThis package is meant to be an initial design prototyping tool.","category":"section"},{"location":"#Installation","page":"OpticalRayTracing.jl","title":"Installation","text":"using Pkg\nPkg.add(url = \"https://github.com/Sagnac/OpticalRayTracing.jl\")","category":"section"},{"location":"#Sample-usage","page":"OpticalRayTracing.jl","title":"Sample usage","text":"using OpticalRayTracing\n\n# Tessar lens, units in mm; prescription from Hecht's Optics\nsurfaces = [\n    # R        t        n\n    Inf        0.0      1.0\n      16.28    3.57     1.6116\n    -275.7     1.89     1.0\n     -34.57    0.81     1.6053\n      15.82    2.345    1.0\n    Inf        0.905    1.0\n    Inf        2.17     1.5123\n      19.2     3.96     1.6116\n     -24.0     0.0      1.0\n]\n\n# Clear aperture semi-diameters\na = [9.5, 9.5, 9.0, 9.0, 7.63, 8.5, 8.5, 8.5]\n\n# image height\nh′ = 21.5\n\nsystem = solve(surfaces, a, h′)\n\nsystem.M # vertex matrix","category":"section"},{"location":"Ray Tracing/#General-Ray-Tracing","page":"General Ray Tracing","title":"General Ray Tracing","text":"The raytrace function provides methods for tracing over a given system or lens while the transfer function provides convenience methods for working with transfer matrices.\n\nLenses can be computed either by passing a surface matrix, as in Lens(surfaces), or directly by using the Lens(lens_matrix, refractive_indices) constructor.\n\n# telephoto objective comprised of two thin lenses in air\nlens = Lens([\n    # t/n   # power\n    0.0      0.02\n    25.0    -0.02\n], ones(3))\n\ny, nu = 1.0, 0.0\n\nraytrace(lens, y, nu)\n\n# object height\nh = 10.0\n# signed object distance from vertex\ns = -100.0\n\nraytrace(system, h, s)\n\n(; f) = system\nFFL, BFL = system.EFFD, system.EBFD\n# positive distance from front vertex\nτ = f + abs(FFL)\n# positive distance from back vertex\nτ′ = f + BFL\nu = 0.07\n\n# 2f-2f system\ntransfer(system.M, [0.0, u], τ, τ′)\n\nIn addition, general transfer matrices can be directly constructed by passing a Lens to the TransferMatrix constructor.","category":"section"},{"location":"API/#OpticalRayTracing.Lens","page":"API","title":"OpticalRayTracing.Lens","text":"Lens(surfaces::AbstractMatrix)\n\nConstruct a lens from a 3 column surface matrix where the first column corresponds to the radii of curvature, the second column to the thicknesses, and the third to the refractive indices.\n\nThe computed result wraps a two column lens matrix where the first column refers to the reduced thickness τ = t /n of the distance prior to the surface and the second column refers to the surface power.\n\njulia> Lens([\n           Inf 0.0 1.0 # object space\n           50.0 3.0 1.5\n           -50.0 0.0 1.0\n       ])\n2×2 Lens:\n 0.0  0.01\n 2.0  0.01\n\n\n\nLens(M, n)\n\nConstruct a lens directly from a two column lens matrix M containing the reduced thicknesses and surface powers corresponding to a refractive index vector n.\n\njulia> Lens([0.0 0.01; 2.0 0.01], [1.0, 1.5, 1.0])\n2×2 Lens:\n 0.0  0.01\n 2.0  0.01\n\nSee also: compute_surfaces.\n\n\n\n\n\n","category":"type"},{"location":"API/#OpticalRayTracing.aberrations","page":"API","title":"OpticalRayTracing.aberrations","text":"aberrations(surfaces, system, [λ], [δn])\n\nCompute the third order wavefront error coefficients based on Seidel sums for a given system or ray basis. Results are in waves at the d-line by default. The dispersion vector δn allows calculation of chromatic aberration.\n\nThe returned Aberration type holds the system totals in the WIJK fields (e.g. W040) while the per surface contributions are held in the long form fields (e.g. spherical).\n\nThe coefficients assume a positive valued field.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.compute_surfaces","page":"API","title":"OpticalRayTracing.compute_surfaces","text":"compute_surfaces(lens::Lens)\n\nCompute the surface matrix from a given Lens.\n\njulia> compute_surfaces(Lens([0.0 0.01; 2.0 0.01], [1.0, 1.5, 1.0]))\n3×3 Matrix{Float64}:\n  Inf   0.0  1.0\n  50.0  3.0  1.5\n -50.0  0.0  1.0\n\nSee also: Lens.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.field_curves","page":"API","title":"OpticalRayTracing.field_curves","text":"field_curves(W::Aberration, s::SystemOrRayBasis; k = k, kwargs...)\n\nPlot the third order longitudinal astigmatic field curves. Requires using a Makie backend. k controls the discretization / number of plot elements.\n\nH on the plot refers to the normalized field parameter.\n\nP, T, & S on the plot refer to the Petzval field, the Tangential field, and the Sagittal field.\n\nSee also: percent_distortion, rayfan, spot_size, wavefan.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.flatten","page":"API","title":"OpticalRayTracing.flatten","text":"flatten(M::TransferMatrix)\n\nReturn the cardinal points for the input vertex matrix.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.incidences","page":"API","title":"OpticalRayTracing.incidences","text":"incidences(surfaces, system)\n\nCompute the paraxial incidence angles over the system. Returns a four column matrix with the first two columns referring to the optical angles ni & nī for the marginal & chief ray, respectively, and the last two columns referring to the physical angles i, ī.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.percent_distortion","page":"API","title":"OpticalRayTracing.percent_distortion","text":"percent_distortion(W::Aberration, s::SystemOrRayBasis; k = k, kwargs...)\n\nPlot the percent distortion for the given system of aberrations. Requires using a Makie backend. k controls the discretization / number of plot elements.\n\nH on the plot refers to the normalized field parameter.\n\nSee also: field_curves, rayfan, spot_size, wavefan.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.rayfan","page":"API","title":"OpticalRayTracing.rayfan","text":"rayfan(W::Aberration, s::SystemOrRayBasis; k = k, kwargs...)\n\nPlot the third order ray intercept curves for the given system of aberrations. Requires using a Makie backend. k controls the discretization / number of plot elements.\n\nH on the plot refers to the normalized field parameter and can be adjusted with a slider.\n\nSee also: field_curves, percent_distortion, spot_size, wavefan.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.rayplot","page":"API","title":"OpticalRayTracing.rayplot","text":"rayplot(system)\nrayplot(surfaces, a, system)\n\nPlots the given system or ray bundle using Makie; requires installation of a Makie backend such as GLMakie.\n\nSee also: rayplot!.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.rayplot!","page":"API","title":"OpticalRayTracing.rayplot!","text":"rayplot!(system)\nrayplot!(surfaces, a, system)\n\nMutating version of rayplot which draws on top of the active figure.\n\nSee also: rayplot.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.raypoints","page":"API","title":"OpticalRayTracing.raypoints","text":"raypoints(marginal::ParaxialRay{Marginal}, chief::ParaxialRay{Chief})\n\nReturn the coordinates for the given ray basis; useful for manual plotting.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.raytrace","page":"API","title":"OpticalRayTracing.raytrace","text":"raytrace(surfaces, y, ω, [a]; clip = false)\nraytrace(lens::Lens, y, ω)\n\nTrace a paraxial ray with height y and angle / slope ω = nu returning a ParaxialRay{Tangential} holding the ynu matrix.\n\nIf a set of aperture semi-diameters a is specified and clip = true any blocked ray will result in NaN in the trace matrix.\n\n\n\nraytrace(system::System, ȳ, s)\n\nTrace the marginal and chief ray through a given system for a given object height and distance from the objective; these are signed quantities.\n\nSee also: solve, incidences.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.reverse_transfer","page":"API","title":"OpticalRayTracing.reverse_transfer","text":"reverse_transfer(M::TransferMatrix, v::Vector, τ′, τ)\n\nTransfer an input [y, nu] vector in the reverse direction, extending by image & object space distances τ′, τ.\n\nSee also: transfer.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.scale!","page":"API","title":"OpticalRayTracing.scale!","text":"scale!(M::Lens)\n\nConvert the second column powers from dioptres to inverse millimeters.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.solve","page":"API","title":"OpticalRayTracing.solve","text":"solve(surfaces::Matrix, a::Vector, h′::Float64)\nsolve(lens::Lens, a, h′)\n\nSolve a lens, returning a System holding the relevant properties. a denotes the clear aperture semi-diameters while h′ indicates the image height.\n\nFields are:\n\nf: effective focal length;\nEBFD: effective back focal distance;\nEFFD: effective front focal distance;\nN: f-number;\nFOV: full field of view in degrees;\nstop: surface matrix index denoting the aperture stop;\nEP: entrance pupil containing fields: D: diameter, t: distance from the front vertex;\nXP: exit pupil containing fields: D: diameter, t: distance from the back vertex;\nmarginal: marginal ray;\nchief: chief ray;\ntrace: the full yu ray trace for the marginal & chief rays;\nH: Lagrange invariant;\nP1: front principal plane location w.r.t the front vertex;\nP2: back principal plane location w.r.t the back vertex;\nPN: nodal point shift from the principal points;\nM: the vertex matrix;\nlens: Lens of the system.\n\nSee also: raytrace, incidences.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.spot_size","page":"API","title":"OpticalRayTracing.spot_size","text":"spot_size(W::Aberration, s::SystemOrRayBasis; k = k, kwargs...)\n\nPlot the spot diagram over the image plane using third order aberration data. Requires using a Makie backend. k controls the discretization / number of plot elements.\n\nH on the plot refers to the normalized field parameter and can be adjusted with a slider.\n\nSee also: field_curves, percent_distortion, rayfan, spot_size.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.transfer","page":"API","title":"OpticalRayTracing.transfer","text":"transfer(M::TransferMatrix, v::Vector, τ, τ′)\n\nTransfer an input [y, nu] vector, extending by object & image space distances τ, τ′.\n\nSee also: reverse_transfer.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.vignetting","page":"API","title":"OpticalRayTracing.vignetting","text":"vignetting(system, [a = system.a])\n\nPerform a vignetting analysis on the System for the given aperture sizes.\n\nDetermines the maximum FOVs corresponding to those sizes as well as returning a Vignetting data structure holding a semi-diameter matrix in its M field with columns corresponding to conditions:\n\ninput;\nstop limited;\nunvignetted;\nhalf-vignetted;\nfully vignetted.\n\nThe fields of view are stored in the FOV field with rows corresponding to the unvignetted, half-vignetted, and fully vignetted cases and the columns corresponding to the full fields of view in degrees, paraxial chief ray slopes, and image heights, respectively.\n\n\n\nvignetting(rays::RayBasis, system::System, a::AbstractVector = system.a)\n\nSame as above, but for a traced RayBasis corresponding to the marginal & chief rays of a non-collimated beam / an object not at infinity.\n\n\n\n\n\n","category":"function"},{"location":"API/#OpticalRayTracing.wavefan","page":"API","title":"OpticalRayTracing.wavefan","text":"wavefan(W::Aberration; k = k, kwargs...)\n\nPlot the input aberrations as a a composite wavefront error over the pupil in the tangential and sagittal directions. Requires using a Makie backend. k controls the discretization / number of plot elements.\n\nH on the plot refers to the normalized field parameter and can be adjusted with a slider.\n\nSee also: field_curves, percent_distortion, rayfan, spot_size.\n\n\n\n\n\n","category":"function"}]
}
